# CHANGELOG

## Unreleased
- Added DB-level WAL checkpoint (`checkpoint`) that flushes tables and rewrites `wal.log` to a compact snapshot (preserving `next_row_id` and embedding state) to prevent unbounded WAL growth.
- Added background embedding retries with exponential backoff (`attempts` + `next_retry_at_ms`) persisted in WAL; jobs only become `failed` after exceeding max attempts.
- Added SST-aware row visibility helper so `update_row` now works for rows already flushed to SST files.
- Fixed embedding job processing to read pending rows from memtable or SST, allowing jobs to complete after flush/reopen.
- Added regression tests for SST-backed updates and post-flush/post-reopen embedding processing.
- Improved SST point lookup with binary search in `find_entry` plus storage unit coverage.
- Added process-level HTTP server smoke script (`scripts/http_process_smoke.sh`) and CI coverage.
- Made the HTTP process smoke script CI-portable by replacing `rg` dependency with `grep`.
- Upload HTTP process-smoke logs as a CI artifact on failure for easier diagnosis.
- Stabilized CI `Gitleaks` scanning by fetching full git history in workflow checkout.
- Made `dependency-review` non-blocking when unsupported by repository settings.
- Added explicit CI coverage for `embeddb-server` HTTP + contract/smoke tests.
- Added HTTP route smoke test covering create/insert/process/search/flush/compact flow.
- Fixed HTTP row JSON handling to accept natural JSON values and return plain row fields.
- Added compaction/reopen regression coverage for row visibility after delete tombstones.
- Removed dead CLI sample schema helper.
- Added table introspection APIs (`list_tables`, `describe_table`) and CLI commands (`list-tables`, `describe-table`).
- Added `embeddb-cli search-text` to embed query text and run kNN search without manual vectors.
- Made kNN sort robust against non-finite distances.
- Added table stats API and CLI command (`table_stats`, `table-stats`).
- Added DB stats API and CLI command (`db_stats`, `db-stats`) plus HTTP `GET /stats` for WAL size visibility.
- Added `retry-failed` embedding jobs (core + CLI + HTTP) to reset transient failures back to `pending`.
- Added bounded embedding processing via `process_pending_jobs_with_limit` and exposed it via CLI (`process-jobs --limit`) and HTTP (`/tables/:table/jobs/process?limit=`).
- Made `list_embedding_jobs` deterministic (sorted by `row_id`) for stable CLI/HTTP output.
- Added optional HTTP server (`embeddb-server`) behind the `http` feature flag for CRUD + search.
- Added HTTP endpoints for `flush` and `compact`.
- Added HTTP API reference with example payloads.
- Added JSON Schema contract tests for HTTP request payloads.
- Added response and error JSON schema contract coverage.
- Added list/describe response schema contract tests.
- Added stats/search/process response schema contract tests.
- Added row CRUD response schema contract tests.
- Added flush/compact response schema contract tests.
- Scaffolded workspace, docs, and CLI/server placeholders.
- Added WAL with replay + truncation handling and basic crash-recovery tests.
- Implemented in-memory tables with typed schemas and row CRUD.
- Added embedding job queue with idempotent status updates and local embedder API.
- Added brute-force kNN search (cosine/L2) over stored vectors.
- Added SST flush + L0 compaction with tombstone support.
- Expanded CLI with table CRUD, job processing, search, flush, and compaction commands.
